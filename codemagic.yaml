workflows:
  build-app:
    name: Build App
    max_build_duration: 10
    environment:
      vars:
        APP_STORE_CONNECT_ISSUER_ID: 7d812fe2-8abd-47ca-9d27-3ed7e62d7b6d
        APP_STORE_CONNECT_KEY_IDENTIFIER: 4X5V82JUU5
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdHODNRTGFyR0c0NU54ZmlUaVNKVmIyT0ZIVlJTU28wc0R4LUl6cnVpdVZFTDVvNndzVGJFN051YVhldzl1VElkZl9YeE11NVJzR0RoOEtoVDVKeFBuak9vQWZHazVvQlpGUTVzTEZWZVo1N2E3aUdDTE0yZVlqbm5iVm5iWGQzdVdHSkxHdXIzaUNmcFJoVTgwemJTQjNjWXVjZ3JUbVJQYnU5d2VyRWE5ejNDNUVBbHd2bFV5UW9TdzQtMlc0Y1gtSjd5c01YNk1rYmV0UExvZzJGZWhyU2o5Z25nMlJZSkJ1c3Bub2RXTVhtMzZhN2ozR1NrQlQ0alVKV29JU0Q3NHcwV1BFQ0FiOWl0b1d2T1Q2WjA3YVBoNEJKQVh0LU1LdnNZMjRHOU9CX3V3N0ZmR3hWU0ZEZEdzdVBwUzI1eXBPWnNXMW82QjQxc2R2YmRwR0Q1REg3UzV1MGNFaGhOZEw4cVBtUjZCVFgzYy02ZExMT0VrY0Zib2JqVkgydkNaT3UzTUlvdEp6MFBxLXYwd09NLTdzM1lBUmFYRk16TkRjS21BX001R1IxU0xFWT0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdHODVjTVRRQVV1WThFS0RQd3FGdmZjeDJidU11REdGb2hEcUMtVFZ6enk2Wlotejk1clRwc0xac3NhNHk2a3h6Ny1XbHFDYlRpNmw2emlMQ091aDZfS0dPYXVZelJwZXctVHUyZUxSZmFpRmFtbHpxeGtjVlpMM3U3cmRCSG9PQzU2c1RERU9qUG9ZNXhUVzJBc04xb19sOEVDbFlWaHd6cmRleXF4T2E3NUhuVjJpUmhxR2Y2YVBsanF4MHRWUjh4eWlQVDZtZWNTTTJiSlhKdnZXaEltQmdfWlVyS2xRYmp2djhyU201bjZCRmN0QmJTblZlS2pNMlJoTkgyNEkzdnozbWFFZmN4LTJUaEhON2sxamFOd212bE9HWUQwSU9VUUpQNTkxLUVfYm9VYnFtc3NUdDY3bFV0MFBaMklmRFpZeXo3RllINnBTcmktZUF0NlZqXzVLWldINERLU2dnZG5LZkFmZjhYaU5CS3piOFM0NS1qY2xBLU9WOGpuVDk0R283azdETHVGLVV4MmczM1I5Z1BQX0ZfQUtPWEpnVlJqTURrLTFDNVhmWDZmLVhUdEtIUndBRl9JSExrYzQwbUlmZm11WnA4ZWhHUXZNaGpLYnRLbXhpTVRxeU9raUlzQWtlWU8yNGhPTUd5WVlYLUhWYkk0a0xoaWZQTGNmemh3TC1EV3hkTTR4ZlVndkJFY19id3NtQXZ3Zi1aMkcxNW5raEM3MC12eC1PWEZ6X183ZnlCdDZjSTNQRm9Pd20tdmdhdjlxcUs2NmUtOF9GcGJwSFpJMExaRks1NEF5RDV3emtCQVFINWtWenhEbWFfV09JX2VXVnFzNnQzMm1TVFF0U0lWV1FGOEdKOW9MdHV4ek1LaVlyNGVjRXd3b2pTZmhpYXRGM0RoVTdfdHd2TFlEMXhsODdPZ1l3aGhxdTZRTlB6V2laYUs5aHdkeXBnRUowTmF2RXQ5WW1UQWJtZlBXZzdvVEtBTndNanJhczVORnVIYktUWDBpV1pkZkVoaW0wS21ueU10Vi1mQTJ3cnZ4VVR6Qm1TcjVFRGhnOUo1d0J2N2hDT2pnQUtGbXZ6dlZJR1UwNkF4d3EtbF8tUlNFTVMxblRlVVQ5VDJRN2NRQzhQYmgyemJWM1BQOFRvTXdwMzYwV29NWVNvS2dTQUFoRzJKS3pZOWtZX3hQclFjVnZrRUlJYzJ3THMwWUZmTE1DVnFEdVZEMnpjdkgyNlRxcTRVbFZkWlhNTDVfQU9oYl9DcEQ0Zm5tR2hncm5WdjNNSFdaLUpLOVJsUUlnTldhYTJ5YnM1ZGxwTDBPOEJpTUU2eU9vRTZ2clFaWXREZ2l1LXRDX3FEVDNYenlIVnloeVNjOG5yYXlHWGR0NnNJNUJFM0RMdUg2VW5ETk9TcjRzZGN3bkRkc2hGelQ5c0FTZ1hhcjBBcFZ5TUlpT2NFQkdDQVBWVm5FdE1lLUppbzhmZ1FvbmJocmc3WVRUMV8zYURtOE8yWEJjdU5ObmxZcGhGc21pVWt0WENwNXFGbUdsU1lxWlR4UXJZQlVnZmFtdjM2R0NSM2hPRkxBVS1XMGFqQ1BjUkxtMDE3bzBZS19GQkhSWjdTTGYtREpBb2JNVjRXeTNfeGlPTUFOUTdFWWFVdHItOTlTcFlrR0FzTjBHOEZaOGFTM3hfcDYxVk9LMVQ2Z2ZZWWxwNmdLbWs3VmlYbG9TajJZalRsZVd2R0hBbDVfN1o1WHVwbkJIV056S1Q2bjdoVDhZWUt0RGJ2cWdXM0cwUlVYaXRMNjdUV2hEYUZmaGotVmlxZUh5bl9sb3hVMzJ2NXkzVXF4LTl1N0hRV1pYcm9qa0wtRlZxSVRNZjdYVFRHS0NfdUZrZlA4ZkRHMWhKLUJ3eGdETU1PYm8wV0dyOUtKR0tST1BrYjMxQlVFRUs1ZEJ1U3EwMjg3d0Yxb0R0MU52ZWhXVm13MG1TQXBMdzdUNF8xaV85NWtfY25KTGNBSF9GOVJoQ1VOV0lFdnBZWE5uS0k1VlpLMHBjdE45bkNVYnVWcFVSdTM1Mktyc3A4M21Ea1gzRmJPTWE5R0QxdG4wUTZ6WDNiZWRkaURKa3dXSnIyUWkxTVg0clI5ZXA2ZlFSYmJVaFZrblZwVV9FMEdiVGRONUJkdUdFY0JUQWFmcnoxc25tN1FlV0EyX01pYWJiMlhpcmpkVEN1VUZyck1NektxQXVsWHE2MVZoblFYMXdYQXZaOWJxRlFkdDJpaExvUzk4RDZQOGtaT19rZlRxMU5zVG1jUkVIWG5RUjJiaUgyd0t6ZGxFQ1pJNDlSTnpPa3QzRUpOZGRPaFB0SzMtVDVUY0dtcFk0NDhEOXMwUDdJTzR3ZllvZVo4eUxHNWRHMXFXLUllV2ltcmEyYUpPc3o2NWN2dkJ1dG9uSHo3bVBkbXlTVzIzaEItSjBTSDFWUW5Ib3hXdUdlQ0dCZVl0RmpPUWxfY3FTejYybEMwME9zOU10c1QtLXpqalZvRWpsT01zV1dIWGEwM0JGaWxwMzduZ2FsS1JzMjFHWnk1WldTNG04aGI4bTNUTEJpWWhLbEJ1cUVJTFZyanotMFFTaFBwNGZyeVA1Z3NLR1NUakhESTM4S25jMWJvT25LcUJ2MDhYNFp3NjdvRjhBbExZM1NSQnVEOGFkb1dUbnZQWkMzbHFJV0xZMkpOYlo2Z3ZNN1hYVVh2Y0JWYmF4REFCUnVwMUFGbmJZYzRJTk9kYmFNT3I5aW1jOVd6dnJnUmRmNDhobEtrQ1k4VFBmMXNaaW52cjZIWUJ6Z0RrRjlaZngtd0xyV2libG9BUEh5MU5vXzhEQkVaUFlMbldMOHZPWk96ZEhSeGEyREthSko3aWYxdkxKb3hpREhDSWp1ZVRoQW1Hb2Z3R2l4ck44TzZUNmlrb0FxY0dEZ1hWUmtiWEVEV24yV3VDalh0aXRvUjNxNUhQRDhXNlFPZDdTZDZIRVlmTmZCZERlQ3JJUG9pREJGNGZ6OHpKYll0cW95UzJPT3dYUy1yNk9ZclVCNEdvTEFkRm83M24yclQwVzdIX01RWkhJWkxh)
      xcode: 11.5
      cocoapods: default
    publishing:
      email:
        recipients:
          - artemii.yanushevskyi@gmail.com
      slack:
        channel: '#my_app_xcode_codemagic_builds'
        notify_on_build_start: true
        notify:
          success: true
          failure: true
    scripts:
      - keychain initialize
      - app-store-connect fetch-signing-files "io.codemagic.banaan" --type IOS_APP_DEVELOPMENT --create
      - keychain add-certificates
      - xcode-project use-profiles
      # - name: Build ipa
      #   script: xcode-project build-ipa --project "ios-test2/banaan.xcodeproj" --scheme "banaan"
      - name: Run tests
        script: xcode-project run-tests --project "ios-test2/banaan.xcodeproj" --scheme "banaan"
        test_report: build/ios/test/*.xml
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
