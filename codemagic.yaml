workflows:
  build-app:
    name: Build App
    max_build_duration: 10
    environment:
      vars:
        APP_STORE_CONNECT_ISSUER_ID: 7d812fe2-8abd-47ca-9d27-3ed7e62d7b6d
        APP_STORE_CONNECT_KEY_IDENTIFIER: 4X5V82JUU5
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdFQmxVcHZGVW40cUltNGs3M1hKbHFsM3BTamVsTk9pUEJzeXFiSHh2cXduMTdyTi1TbEluRzhNOEZQSzFIRGVTaUMxWkR2SVBCMlBoVHJnUnloZ1h4QWtZTnBwMnFJVmk2bHpXRXg5SElYQmtTcVI2S0t2TEhacVMwNlVkRTRPa1NzLXFldDBvcXRuUHdsdWdzZnpNbEZzTTVJQ0FJc1hhNUQzT0p3eVMzMlk2cHZuTWo5aWhlOUZaU1MtVmVNYXpBeU9SSmd3SkctYW5kazdPWF9nY3YwaFhfOTVUZnRleWdhNWdOV0xRN0c2OXJIUTV2UERSRHBESldaVW1OQ0tYbXpNRzY5Z2R2UkV2Ulo0TDAtTTBmREJtT2huZ08yVHdNNlY0bVBwMTRBQ0k1T1VuckY4NWlpRElDc2x5Wk1lOElzbGp1a0h5SjBOQkZaOGx3Yjc2SERvcmVQcmxsWnh0b1E4TDM4UkxuWklqSDBmZU80djhNZ0xKTjZuQUlFaWJpem5hdjhueVB6YXR2R3ZTY0NQRnVmblI0SXk4Szlub1NhNDRhX3l0VzFRZThzVT0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdFQm14REQtVnFGZlRpLVJ3LWY4U2ZadUJDSlRsb0FLeHdMR3haZWMyMW83RjVMdDNqUGlINzlTVnFjSGtrU2pDWnBtNDVVdTlwbUpTaVgtb25FTHg4MTNYd3huSlJHcW1Na2p6dm5PR0J1WUtJdTY2SGdlcXBSTHNLZjdUWVphSzFxd0x3V2RJdkxpRENvYllVUEFrLVVZYVpJRUZ0TlZ5Smd2dWJ3aXhTeHY3QUNST2hLUk41WEdCc1o2REF1OXdEc3VOZlNENkp1NU8zOGxCd0pOTDNHWFVsVDl4bDM2ZFo4SDZrWWExdUlUd0h4V21XaWFUSWJPNWM3X2pySXJtMWY4SVZSc3R1WUpOZ1d3dFBQTWdCMllOSjdKWWNyRm1ibDhfa1pEZnpud2JYakNtXy11cDUtRHNlTUdVMWh0WWlHdEVvZnlUTngwWl9sSW5KX0VHOU1IQzQ4Z0FpcnA4VWlIWUJiaDhwM2JxT1UxcV8wWEpERjdDV2ZBTFQ1MHJFczVidTdnOGFxbTAtSEJveWEtY21YN1haaGpIcllrUDlLSGpnRzlOOUg4YWpTdmE0cVlkLWU3TW5zRFcweEl1dElLVmdmVHQwVE1mUUUxYU1qT3JkbTd6QjZydFdtZnM2bHJtNWUxN2x0NHdfZGpMSUtzLVZraGduZ2N6VXZlYWgtUkxkMF9KUE92SzVqU3FOZFNFUnhrTk1lNkhiZS1UV0JONWJrMXhUbzBvT1hGSmR5VF9FVjdjSnJEUmVhbkVLQXI3aWJTeXlPS2ZTRkd4cUFJQmZ6b1djaHE4OVYwUDFqTVZYV08wWTliWXlIUjBYbGQwRGd0YmhPWGN3a19jNV9nV1BaeXEwa1NsaXFpVm5YamVLbVNReHVsSDFGSktXbW9uR2ljcUlWLVdkLVpWcVE0ZDloaHVVeFZQUElqR2Q2SngyWXQ2dTI2Mjd5QkF4eXctOXprS2JxSDZjd2hMaERvNWNjenFHdmlzdUgxVjhkVENsVk12Vm1Qa3F6T3NMN05kemFaVDM2dDg1M1d4bzdjTWFXLXY1cmFYS3NEMUZWUGZremxLd3I1VThSVlRRQWV6ZXhnMFdrYmNWUFpndWdncDhmOFJJdzF3U2ktbXVsYVFfY2ppYTh2cFR5ZmlDby05V2JFM19fYkZEaEEwSVBVSWx2dF9XNU9taTJ5SE82THBsX2VjT08ydl9CY29fZFp4MjZtcTdHRTNDWHNvampuZjNJRXVMQy10bUpWeE1zbEJDWW5lSmJZemR6QmhzUFAwTFFPYTI1aWU1RFhuSHR3TktUaDZjY2FXRHFwNHpfSkkwT0JRWmp2SW52UmRGYmhDcnZMaG5OT0lYSkVEZlpJeHhPQTFxcnhXcXVwZGFrMHVseF9iSEtpandkUlYwN200RUVNNG5NdkZ6ell3VWxsNmFwSU5zM3pzZXdnMmxma2FsMGN0SkkwRHJUbTNFc2tOLWZZT2RRRXM2ZzVsNGQySnR4VEl5SlByZzdRbUpnY1lTa2QwSWRwLVRkYmQ1SDFQU216X080TUdkYW96eVV0ajcxTDZEVTliQ1dHVXVjNzdLdXRBUmdKNjNGNGZHckRlb3R4TkRQWG1GU0FxS0NPNTBzQ3I5eEZJMzB2UzJlUkJxYTNkdTh4Rmt5cVdUN3FfWl9wS0JzUEMtTWFNVmxwQnpwZnRlZ29iaWZzc0pUcUtvT2Jld2psZHQyVl8tMmZ6UWhkRElRRHBfdnludnc3Wl9CUEIwcU9xWkUyQXNTb2llbElHYW5BMTVYNVYteHpZcnNja2pwMUlWRUtPSW9KcUEzNERxUmNRYzJ3WElxMllmaWc1dFVWX1hMRE5VU01xaUlBWmlremxlOGdyVndjOWhQaVVtQU9YNW00N1BxMGRqdGt3X2psNC1VMGNPTUZucjJ0LWpjMGpqci12MVBOMTV4X283TDR1S0Y5RzBOcktzSGpQUVRrTmdWQ3dvaE92MEdIb3hxZDh1UGxtdW4zMjZ5WV9FYXVneUk5XzJGcVV1aUprMTB1MTNNbUtpQVhMTm0xWWlXQmdxMk5qUFNFbVpGa055akJqMk5CMjRlV2t5cU8zSUVZbXBZQUhCVDJRLTczXy1BZ2NVWXVEZV9mMTJ2RU11SEdYX0ZlQ1BjN0t3OW40cllhR1hVSlJOemVhQllOY25Ic1dlRVFJOGVPODlzanRYRFB0MUtJYTZoRGVWYlJWQ2ZxbU53dTRCb1BDSHJYSVBCVTMxLUhGT0hYUjJyZXJ2Z05tck54NDdod1hMZEhGdl9QbVhBdUV2RjN1ZTJuRXg0SlU3MlcxaTBWTnZfN1VxRTVMVFcxa1JMbG81WUU1Q0tmd2FXNmQ4TjJSUm5qcEpsY3ZrMVFmZmtQVGRYeWJMbXFRdDRhVlZVUUMwbFpta2pOTElHYldrdVhZVVk3NzJ4SHd6THY5S01DclBtZ3l1STJYLVpaTnI2MHZqLWdNUk54dVVRMEZiOHkwN3VTbnNjWXR1cHdfeURjRmdvekUwMm41LXIyTGZWY3I4M2NHOU45WEJWYUxiVTh5R3NQMWY2U3lSQTZsYUJrQ3RDUW5ZUFV0Vk5TcTRBaHZCM0tJMTFVZ25majNCNE10dHBxQkJCVkFlajYwa2UtUmc3UWZRNTVjemV6X09ZVWJUQXlLb1ZtWDVFbXlKdDZjcTJNdlpKN3V4Z0FsaV9lMGszOVN5YlVOWUx5dl94SmtiTHlxaHo2OHB1d2dGenFQVWhvckhpTHVHaHU4WmswaTN5TTRtVS0tb242MWVGRFhZSk9GUlJONE54c3ZQeXFjekZpMWtpRlpMZGdmVHBZWjhSS3kyUGVXcF95Z0lJQjdQRmU3QjVaa3pwOXp2WEFxaXBBazRvSjJYX0JTSjlSVWRmdklxUUVsWlZ1M3dwWlRNSWU2dm5mOUFlWUM4TkNILVpmS3VOdkMxYXctVmh4ejJ6cExfVnFyeXBiZHZ5U2lwRm9zVGh1UUhaYkhvXzk4MmNpTkZYOHlsVHBRWHlZYW9aVUJsa3FmdnM1T0NSNHNOVDR1RG90dVZQaVQxODYw)
      xcode: 11.5
      cocoapods: default
    scripts:
      - keychain initialize
      - app-store-connect fetch-signing-files "io.codemagic.banaan" --type IOS_APP_DEVELOPMENT --create
      - keychain add-certificates
      - xcode-project use-profiles
      - name: Build ipa
        script: xcode-project build-ipa --project "ios-test2/banaan.xcodeproj" --scheme "banaan"
      - name: Run tests
        script: xcode-project run-tests --project "ios-test2/banaan.xcodeproj" --scheme "banaan"
        test_report: build/ios/test/*.xml
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
