workflows:
  build-app:
    name: Build App
    max_build_duration: 10
    when:
      changeset:
        includes:
          - '.'
        excludes:
          - '**/*.md'
    environment:
      vars:
        APP_STORE_CONNECT_ISSUER_ID: 7d812fe2-8abd-47ca-9d27-3ed7e62d7b6d
        APP_STORE_CONNECT_KEY_IDENTIFIER: 4X5V82JUU5
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdMak1CaFdrUHlsM2VSaU1VeVVkVGs2QkhHeDdxdlJCZWJMYVpPZ3lYUTAyUjEwZG9mTlhodjJvSU9xdjR1RUhnWjdFblREcS1DT1JQcEszNzhWUUdhbk0wdU1UN3I5OTlGV2lIS1J6VlduYWdsQXZyM3VENV9OelI1WUpwTXpNWGVJLUNOd3U5QnhEd3NMTU9mby0teW9FVUV3VTFveWdybmQxcmVyMk92NFRveTZCUlZ3cDdWNXNfX0tHR25MaWMxRnZ4aDNMbzREZ19ud2xxQUtsTHpDdXdXaWgtUDVDSUZqU1RMZHc1eTJhZUxuQ3dkRlRXTW95dkxNM2hWV2w3enZrZzYtUkM5eVZqZEdxalh6Z1luVnNnOU51eC00ejZhYWVERjhFMHpYc01kUGljOHlXdEVUNkdBaXRxMzNEaVBQNFVzOXIwVVdCTi1ydm1OVkU0Ulk5eUZzbkRLVDJsdXBFcDRGY2xVeldvMzFnYmU4eGk3dm5WeHBDcHNxajRyQUtwZEgtNWNQUmVud292R01HS2R2YkVVaDZ0S3U0eEZfUEwyR1hEY2J5aDVETVhfN1ZZcGhTXzU2OXU0QWVOYl9EM094MV82b2tyY3NNdWpxc0I5dU80R3FOaWppSllIaWdacnFZUUM4U1NZbnJ3Q0JfcTE0ek40VHBEaVo0eFJTVW9BWEhVWmdMcV9Vb0Q2TDlCei1nZWFnPT0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdMak14azN6bnVldDJEZDlFVkg4SWN0YmQ5enl2NnBObmdJVlNTQ1lCeF9fbGJRZ3VVSzktV0ljWmFyTVItYm5XRjBLVjBqRHdRWHg3N3hwMDdCaTU2Y2kxcC1heHp4RWNEdGNQTTVyT2hGeWxDRTVrekE4cWg1bi1sdjhCTUpGbWhRWUt6VDRkVDZCeTdTNFRXWkdqVU8wVDZHNS10dVNEemRWXzNLUGlSQWlENi05VUdxZGZHZk1RTXh5ZTF3S0U0Sk9TVWRQbklIUFdoNU15cW1UQzE2QTNqLWNpRkN0TElCZkJGZl9BOVdCVVJfbnkxSjFuMzNBVlRqb0pNNHVIdE5BYlM5aHFfSnB4X0VqZW5MbGJqZHN4NUJNR1BmT2xfYXAzOUE5aHhQRDJMdEg0ZUE1M2hZMENSdjlTVzZaaG1zNEw0ZVRmZzFsOC1hWGN3czVwZTlpZWlyMTNuMWt3bEhuZlNfNTFsVWNMYk1Bbzd4TVpkY3dvX3BOWDBlV0RzdlhKRGZuY21GWG1rOUtjQnFQdENKcTN0eV9JWW1oUGNEOHRFT2UwV3NwMEdCMzVONi00ejhpU3hTaWxucThNNE9xSE5IX2pFVEVPaksxVm5VdzAxVF9jeUhpODgyR096UHpJRFFqMER3YkJQaUxKYi1IQ3BOcF9YMkloR0cyWGMyWDIwdnBteTc2bUtQS2RhYUFocHBabGQ5cE51OXFjSUlaZDdWTnJJY01yZ3NmM0stSWpNNW0yUE9OMkZjaERibE5WUFQwTjN1R3BCSGVMeGJ5dmNTTUxaa0VnaXlNRHY4b09YRkRqZGJkQ2hQaG0zQjB0bGM5djBhUUNXdERlUk1JUWUzVThMNXcyVktpUC02N2YzTk9pV25jMkhSZWxMdHVyRXdUZXQ5dDdJcGRrQVpWWkJxeXQ5Yng2b2gtVmhBTEZuQmd2bkt2T2ZSU05jYTMydFotQnZPU01XeHZQTnNUR0NxYVhoeFMzMjlIMUtqVzJ0R1RUaVRpNXM5YkhxZ0h2NEZyRVNCUHVCSjc4blZQaVZwTEJPekNFMXo0TnB0RkNodDdRT2xIVWJma2c2aFUtVVhwQ0Racm10QXg5NTdwMWphbjZLMmpycEI1WE9pRkpsajVwVGpmQUk0MjlsZWg0ZU5Bdjd1aGtLR3MzUTM3STRlVGZUMndyMS1hOEZ0MXNGRk8xQmQ5ZjBmR0hQbTYySWlucDJ0bFdZTkN1blRzeTl4cW1SYS1OZFN2Zl9fdllqX1M3Q0RJWUwwTzAyODR3NTBWV0oweHdvbGgxMWxOVUJ6WDRCaklPSllqZ3IxVjI2cU1uVUNlR180WmUwOFd5Vm1SOWJiYmFSakNlVFI0a3ZlbnlyZF84S2dFMDY2SDB0aHdQMl80Wm1GbFBvNTA4dVMtQzJjUF8tc1VSUnMzRlZhd3JvWUJQdXBlZ3ZpblhGdFhWd2hWUE1VdlRGV0taOG4tNGRqUTlLVmYxUW9OaFZKUzV2bkdZS05RTWx2VVp2YzdSejR4dWprSk5EWG1qaGdCMkRzVHlmNmFxTFFMYXZsZEY5WVE4aXQwcmhoWTlfY0RhS1JtdWo3b2kzOWtCaUVaWkdDV1Q1azlBYUQxR1FwYWw4blJuT3NxSWhncjVDdUJ4d1g5ZWFqY2VyX1ZMZ0xkODFSOFFnbEtlMFg0YnRHdWRkQkZGWFpOOUhYM3I3aVRobWxmNnRfaGdCOFBCZnFmQlN2SUVwWUhhd1V0eDZ5YmUtdDBjU04tZ0daUnpRWUFYVE1uYkJRUENkRUdFcEZLVTQtS3ZOdDJ4RjFNMXBlNXVfNDVZUFlES1dVZ3VPcmpVWm8zcEo0N3BOTDV1SWdJanBPcmhySHZxNnc3TGd0VlZuWTVSLVdic2tCSVVjR0RUZkJiX24tUmR1emMtT19IOHVnNUNrTFA0WlVGdE5UMlNEV3RwSERod0RFeVBpRkt5eERLb3hmTnZBczlDYkJ3eEdxOHBweThOTTl4SUZMRlZZT1V0akpxX3h3TDBKMGo1TUtURjRBcEtIQmFnczdGbVpSVVhOb2RVMmNnRDhta3F2SERpYUFWSV9CWm4tTnMxaDA0a25IU2VrTVp0eGNBN2NhU1BNUVFsOU5JNFhyTzNCWjZZWUJxanlDcHBDZ1R1VzhVRVpoT1NaNXRoTkM4anBaNGNhbGdFcUZ6ZVR5dU9hVzliZ2I4Y0hlTDY3V0lzUVF0bm5XbVVIaXVrUVJteFlSZUt6bl9QZ3B1UjBLTW1HWWItTXUyQzZDX0tMWVpnd21tVlQ0bjl6UlpmeXNoWlFYWmNpRm1ndlN5SjhNZmgwTnZSSENZS1ZLQ2kzM0dfcFIxeUZleFA1WEktRmhqLUJBaW95ZFZBUEhZQVhZa2dETkxlQzJWY1FjUUlubXJSVHY2VVdlRW8wZHlXZ1YwN19DMDNHX29PeXVObGlhYjNWT05PaUtuRTlMeFdhb3Jtbm9GNnpXMDFXSWhoeXRvalhOVExxYjVvV2hXTWJDMzBiNS15VHBoLVlVT0hXaEJLdUpKSW1vR3Z1R3YyR1E2aWNOM3Z0cFF5VTA5MGVXeVhhUXhFdnRmcWVvRlltc1dIdlFTQms2N1lUMks4bU5BUmlRMm9wRzhyTWJWSTdRVHRhWnE1YkF0SzZscjJmd1dIZUdDMDNvWTFSWS1PQjFaU2o0Z1pqSHZGd3RsbE9pRXBsaEZPekRpLW1UaHYyakJicGZicFNscGtObER5TmJveW9xTDNjOHNUNXB3WXNSZ25QQ190R1p6VktINzRBMXhXWXJINGhvYklaUGtZMTlTMjllS0pwOVJpV1paLUE3Z2dhblQ2c0xDSFN4d3hDeGN5WFZCYzhOSmhyRkVuSHc4OHotRTZKUm9tdjkxZWZCQ2JqUXU0SXNTUGJNYWpNenhQWTlrdjFMMjRBNkNFQ0pUR3d3SzVQSl93VkxTOGg1a1B5akNweHhfR2lRckhFMzY0OTRmZkJzbVpKYk1NbHhHUldTN3ZneEduTlR0bjFIWHJGYzdrNWduV3ZNTnBoeFFIOFNBVk03MFBPSF9zXzdXLU9BUkRDazFhZmlranIxYWViRlI1ZExLa3gtRU5GbkxxZFRnOUVwUWpuaXNpUmNXdE9hNzhxT3pCY1ZSejFFcTA2a01qTWd6TmE2WjFQLUJHcHVjRktHUGp6TDN1TjRoc1ZOSVdldi13dEFPS1V2WnRJa0FESVdHNU5fYmFHNzNLV1RBbXI3YVd2OHVjRHhFUmhTTHBvcHpPVmw2aXhVZjRVMnZhUXp6NzZVd1dtYUlxd1BET2h2RUIwX015RGlHdG1WRFd3SWx0SEJIaHFNTWE0SHZja25pUlNtaXNkakRENzh6NmFxQVhiZlMyZm84eXV4MGdwaloxYzhmcGNuU0lGMDVSd29ia1RLWkZPUUVCV1pqdEVtV0xTeFpjcG5ZYzF6QXY2OS04UDlVWWJIVExod2VzWUpwWWVkTS15eFhmMHF5bG0yS3RMV21iR1MtSnVLTXFOZHR5a0Jpamd6STk1NWJKb2s4MWhkOGxuQ3pOMjN1eC14YkR3Y1lEZXI4dlBGTm5hRDdtbERkQ0dEVWJsaEp0UkVsc19sbWV0bnZ2Y3UxUEt6RmJPWGl1ZVpOTTlfMDFiTUJpbUdzV0c3cGdUTzJseVIzdkwzVkRscmVXZWNBWHFGQm91ZDduaEpxSFRxaFplei1HYUR4N2tib2RvWnJKcDUyRUhtbzZ1S3JrNFJISXpnU1laODVYektOWTFmcmFaTFkya25reVZHVXgtLThZYnM4VFVpOTFsdTJveEZFSjVla1F2WVZYM3AzMUEzMFNhYi03cEFtLTJhRFBwQ3BoYjFFc25MWDFyaTYwS19XVU5hM2d1Q3dsQnA0cUJ0ek5ESWdZNS0zMDJiZ3Z3ZWo1V3lOcXFobm43ZU13ZHlJNjRHM0V1TUk0a3JMQUdNek5VLWFBdk1NbTdkaXBiQ2lrY0dDX0pQNlM2QTZMZk13RVpFSllSU1B2b19wX0FxdHBYaFk2UWc0QmU4OE12STJkTFJyZFZNU2hsdmRXY0FFaFZhWVdFREcxLVN3YnRXVGRzRFRUaUdiWHdqOWk3R2FDRWVxQW5YU0JRYVJxb0txUU41SF9YMmF1MzZ6Rk52aHQ5RmsxTmtIS2c1SkhzMzRreF95aHpVbHdseDVRWUJxQWZQNWVic3hxVXJUVktnSDBjVTE3NVpMQWlFSHZXemVJVkZ4NmIydkV0TWQzd1hKRW5rWVBRZkFZRm9lN2pmRzZUX2JnNFVvOUlWaVNpUm1Oa0JQVUZEWjFROXU4ZEpTSlRQbklJazhzTmFUY1ZUR0JIMWk5dGhvbElxUlRKYUYwbi1za3FHaWw0VkhTWTZVekU1aExEZFlfRm5HYnZwV184UXlqajl0X0NDUFZUY0l0eXc4bEhmenZwcEQ0ejFVZzc3bXFxOGlHZzZUamtFSktpZnk4WkxkemNoMkhQd3M2eFM5MVJqYkhMdVhhYmNJWDJ5WF92OE9pU3VPbkJUYXg0S1BZYXA2X052YmROYjNMU2lfLXJ0QThHZHE5VkJIa1VEcTl5eWppMnlPOXVCOHZBMzVkRE5FR3R4ZmRobnA0QWZQbkFvcmtmZXNabXVuZXN2d1o1NDVjQjFXcVYtZnkyOUQ4VHJpMHh0TTVhaUJ6NS04aFVSY25GOGFCbEV4SWdoRU9nRDJMREdPV1Awd2xUWTdWLUFIMUhGaHgwR01jeE5pWVNyckJZeDNrdlpEem45czdfMXFBaHJlM1hsU25udjQ4dW4zemhJempLOW9vNDFKY2lkcnZId3R3QTVRSDRzbzJwQkcza1pTNE5vdE96YXRSSWJGNzVJSm1mdWRFN0w2a1JleEhPUXVKZ1FOZldFTFl1SS0yNkYxdC1uc3MyT1BLeWVmeDhhUm1temo0aDN5dVQ4Ni12TzNVNjZnbkRiSzVKelFjYWxkYTQtUjVlOHZTRkt5TGUyNS05d3BCcmt1Rll5b21fTnIyVWlzNnNvbUFyTmJtcmkwTlY2MGpFc2NHRnJPNWkyRXNUSDlGaWdGNGlPbGdpbkpHZzVERWN5UmRCNDNNZ1E2SmhtWmNJeWdLSllNal84bDhDN1BKcnJBTkVUUFZaVGhKd3plT3QxcGhzcUNxUHdNVWVUZnpLX214VWxuZU1Cdkc5S2JVS19PbThCdWVGMnZkdW4wYWVESmpwRFZPaGRMbFhrSDBtTkhobFZXclREWTNka1kwcXNLVTNQRDAzWHhDVjFrU1FITnREWTliYlBDYzdES3lfX3p3WEdDdkZkZFcwYVJFS1BJTUlMcGZDTXc1T1JOVkZ3QmpwYy1raHJiNm9fdk9NNXFjTko2ZDRuTWdEMWpTOElpNUlpZ2VlYW12dW1wdmNFX0JlTUM0ZWQzVktRUlNJeTczSGlJb3hNUlZJQzJuYnkza1BKaFBucUxfWGhKcVVLWG01Q2xMSGlhNlhTcU1FUVFQVkxCenJpX0RoSHBHNUFnZmVFU2llenRRcWpzUTRHSnNSdFZUTEpmUEVuZDFhMXhQTkY4RXoyVnp4S21pNGZwZmUzWkhuUGR4MzdidE5XWTYwMHNKdGl3bW1PZXlEemFvcVRGeVVEc2FnT0ZUODFQZk9sdTFzeGs1TTZBd3lnRlpDcm9vSHRSV0VhemJNQmpLMGRPQVNGVkttbHRpNjM1dXQ0VURyUDlIN2ZNRGJpS1F6WWpsNzVLLXBJSklCbkdnb2xXeHp0UWFleFpLWmtOWnpzSzFzZzFmUzBPb0dVUGxjQmZEMmZUYkpnUnRES3dCUk5LQ0M2N3lnbzBXRFUwc1B2OFl4MXVPWUFSSWZiSkFyZDI3bUJfMy1FS2RDekpPZFVtQzc3UGQ0cWZXSVRURy1XZkhxS1ZpcGtJWlNyRVlPZGN1WWtVRVNMZUZybU5YV0VEa2hQU29WVlgycHRWbi1RdXYybE9MNVNvekRVNEtiVU1oSzFGcjQ4QjFJb2RUZnFRMjRieHVhSDNxQ2RJMTBxekdUbVdFM1lhNGJvVVB2Q21HYUt3QmU1Rk91SDdHaF9mbm9SZko4U0wtazl5YXRMX3RnMVo4RnpoeGh1cHZ1cm13RW9SYUdGMDRYYUJXYk1UN0ZwMHRFWHVlYXgycEJYMjNvM1cweWoxTjV4bXY0MEJCemNEYWx2dE55MU9ubjJxQ0FxT0ZDTzJCX0RIb0xrVUdPaXIzQlVBandzcmFqWVZ3Wmp5el9zZjE1TGdWazhyZUZJN0tkU2dYMGJYZ20zQUQ1ZlBvZjIyQXZWakljOXJONHV0dTRjeW9ISTJ1YW5oUThZUE1xQjR1VDlJNTVRWWEwUjd6RmVXVXRscjVfbE5aVzd5YkFKVWFUMzA0SmZQNTNIUEtuRWhCQ0lQOE9zNWlpeEFDWnBqU2VIbzd3ZHlWWXVyeHFLVG9JSVd5bHlweXBwREdhdjVpV3FFRTZ0clJQSklJVktlZzZiYkZjbTlLbUVObGF0c3E2QU1LS28xR1lrbmpvMkx3MVZqMUFRX3RSaU5DNHptQ2sya0lhSHJHMHl3U25fOXBYOVAtTFI2eWZBXzdmSngzMmN1QTlISlVuT0VqRnlQVmRzWnpGNDRNcGxnNEkyamliRUxxTFdvNmlYTEdtMkVIaFJHNjNibHVrdURNNTZ2XzRZQ04tSlpXdTA4dzA1RGF5ZHNzX0w5dl92cFlkTXhTWW94QXdFRmh2ZmVVM2d5ajg0VlRxanJKR2ItTnVna2Z3ZHFwR0tuNFNoVFRRdzdxWkgwRTN2a1JlbHl4dTJDVWI2eW44b0NBNDRKYUR4cFR5YkFHRUlrdG9WWVNMOVNnV3VMYVFIdG5FdmJUNW1lQ0RNY2sxdG5Jd19Qb1VDNnpVM0lIQUlRMXpQUWhHc0VYWnpzVlNkMFo5T05IZFpIY1VuVmJRaHVpVE9iSlpjTWh6S1o4Qk9BNW43UlJmUnVWcTV0S2dQY0RHVzRqU29ubjZ3OXFPUXlfWC16MEdoS3VmN1dIWGF5bHZTS1NFeDRoSUdOS3hwT1ZyVXhVV3ZJbWlOazI0U3lDbnpNUTFFVUtKWnlyNksxYnZOU2FybmNpaDFCdzZsWHRxREM5NllwWHp0YnhUVktYaEFtU1lpT29WTE44NV9NNzRmZlAtdXdsZlVjVk8wX2lVVkMzbDZXbVFFRFExRzd5ekI5aXZoRk0zeFF2WTViWjlzNEF1MmU4Y01xWngtU0daZFEtQV9xZjJyRXhjU3lzdldIdGZrbFE2aWNXbGh6TFFHQ3NZZE5CZ004bGpqTXpGcV94SmhkX2lXQkc5LWxFdThZN0FOTlZ1SHVuRG4xMWRSVjNiWkE1UzhWOHNtMEVjMWxNc0xxMnJjSXlmUFJGanJVN3pLS2F4N2hVZmJJVXk3RTFtSk9aWnBJeWdGOTJvY192bGJId1pJY3ZZUHNtN3AwQzNVaGVIRzVmT0tLcWRhM3ZOSjNuTU54NkJUQm02TER5eFlXaTF3SjdDWUE2eXowbmpiUXIwemd3Ukw0WkQxdFRScEVXSnRYM1V2WkRyWTRhQXFsdWNpMjZRdFNzekh5c2podHhZRjZMbV9IUS1ocWZnNHBybDdVZEhaWmpWeG9Gb0lWejFwR1REMXh3NllncHh5NThPM21SdVZuOGUtVjZIV1NkeFZINVExOEV5N08weXc1bVZxYzdCRWdGS3J0V094UUNweF9seEhGQkRYRWNUTDRqb2dzMlhpS3d3VFhGNWc9PQ==)
      xcode: 11.5
      cocoapods: default
    publishing:
      email:
        recipients:
          - artemii.yanushevskyi@gmail.com
      slack:
        channel: '#my_app_xcode_codemagic_builds'
        notify_on_build_start: true
        notify:
          success: true
          failure: true
      app_store_connect:
        apple_id: artemii@nevercode.com
        password: Encrypted(Z0FBQUFBQmdMak9maTR1U2xWU2JCMlRCRHZBZ2dmaFdkZG9udUJBNldaNW1LU0RvYmU1N1Nhc2I1QTJ6MUE2OW91V011UjdVS1pEQk9wNGlmYS04SV9fM3VqN3ZhRldSMGdiMkc1eTRwaUFhS0hUV05FbjBFV009)
    scripts:
      - keychain initialize
      - app-store-connect fetch-signing-files "io.codemagic.banaan" --type IOS_APP_DEVELOPMENT --create
      - keychain add-certificates
      - xcode-project use-profiles
      # - name: Build ipa
      #   script: xcode-project build-ipa --project "ios-test2/banaan.xcodeproj" --scheme "banaan"
      - name: Run tests
        script: xcode-project run-tests --project "ios-test2/banaan.xcodeproj" --scheme "banaan"
        test_report: build/ios/test/*.xml
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
